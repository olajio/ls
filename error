[root@MS01-11ELKDEV02 conf.d]# systemctl status logstash.service -l
● logstash.service - logstash
   Loaded: loaded (/etc/systemd/system/logstash.service; disabled; vendor preset: disabled)
   Active: active (running) since Thu 2025-09-18 01:21:31 EDT; 11min ago
 Main PID: 129930 (java)
   CGroup: /system.slice/logstash.service
           └─129930 /usr/share/logstash/jdk/bin/java -Xms1g -Xmx1g -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=75 -XX:+UseCMSInitiatingOccupancyOnly -Djava.awt.headless=true -Dfile.encoding=UTF-8 -Djruby.compile.invokedynamic=true -Djruby.jit.threshold=0 -Djruby.regexp.interruptible=true -XX:+HeapDumpOnOutOfMemoryError -Djava.security.egd=file:/dev/urandom -Dlog4j2.isThreadContextMapInheritable=true -cp /usr/share/logstash/logstash-core/lib/jars/animal-sniffer-annotations-1.14.jar:/usr/share/logstash/logstash-core/lib/jars/checker-compat-qual-2.0.0.jar:/usr/share/logstash/logstash-core/lib/jars/commons-codec-1.14.jar:/usr/share/logstash/logstash-core/lib/jars/commons-compiler-3.1.0.jar:/usr/share/logstash/logstash-core/lib/jars/commons-logging-1.2.jar:/usr/share/logstash/logstash-core/lib/jars/error_prone_annotations-2.1.3.jar:/usr/share/logstash/logstash-core/lib/jars/google-java-format-1.1.jar:/usr/share/logstash/logstash-core/lib/jars/guava-24.1.1-jre.jar:/usr/share/logstash/logstash-core/lib/jars/j2objc-annotations-1.1.jar:/usr/share/logstash/logstash-core/lib/jars/jackson-annotations-2.9.10.jar:/usr/share/logstash/logstash-core/lib/jars/jackson-core-2.9.10.jar:/usr/share/logstash/logstash-core/lib/jars/jackson-databind-2.9.10.8.jar:/usr/share/logstash/logstash-core/lib/jars/jackson-dataformat-cbor-2.9.10.jar:/usr/share/logstash/logstash-core/lib/jars/jackson-dataformat-yaml-2.9.10.jar:/usr/share/logstash/logstash-core/lib/jars/janino-3.1.0.jar:/usr/share/logstash/logstash-core/lib/jars/javassist-3.26.0-GA.jar:/usr/share/logstash/logstash-core/lib/jars/jruby-complete-9.2.20.1.jar:/usr/share/logstash/logstash-core/lib/jars/jsr305-1.3.9.jar:/usr/share/logstash/logstash-core/lib/jars/log4j-1.2-api-2.17.1.jar:/usr/share/logstash/logstash-core/lib/jars/log4j-api-2.17.1.jar:/usr/share/logstash/logstash-core/lib/jars/log4j-core-2.17.1.jar:/usr/share/logstash/logstash-core/lib/jars/log4j-jcl-2.17.1.jar:/usr/share/logstash/logstash-core/lib/jars/log4j-slf4j-impl-2.17.1.jar:/usr/share/logstash/logstash-core/lib/jars/logstash-core.jar:/usr/share/logstash/logstash-core/lib/jars/org.eclipse.core.commands-3.6.0.jar:/usr/share/logstash/logstash-core/lib/jars/org.eclipse.core.contenttype-3.4.100.jar:/usr/share/logstash/logstash-core/lib/jars/org.eclipse.core.expressions-3.4.300.jar:/usr/share/logstash/logstash-core/lib/jars/org.eclipse.core.filesystem-1.3.100.jar:/usr/share/logstash/logstash-core/lib/jars/org.eclipse.core.jobs-3.5.100.jar:/usr/share/logstash/logstash-core/lib/jars/org.eclipse.core.resources-3.7.100.jar:/usr/share/logstash/logstash-core/lib/jars/org.eclipse.core.runtime-3.7.0.jar:/usr/share/logstash/logstash-core/lib/jars/org.eclipse.equinox.app-1.3.100.jar:/usr/share/logstash/logstash-core/lib/jars/org.eclipse.equinox.common-3.6.0.jar:/usr/share/logstash/logstash-core/lib/jars/org.eclipse.equinox.preferences-3.4.1.jar:/usr/share/logstash/logstash-core/lib/jars/org.eclipse.equinox.registry-3.5.101.jar:/usr/share/logstash/logstash-core/lib/jars/org.eclipse.jdt.core-3.10.0.jar:/usr/share/logstash/logstash-core/lib/jars/org.eclipse.osgi-3.7.1.jar:/usr/share/logstash/logstash-core/lib/jars/org.eclipse.text-3.5.101.jar:/usr/share/logstash/logstash-core/lib/jars/reflections-0.9.11.jar:/usr/share/logstash/logstash-core/lib/jars/slf4j-api-1.7.30.jar:/usr/share/logstash/logstash-core/lib/jars/snakeyaml-1.23.jar org.logstash.Logstash --path.settings /etc/logstash

Sep 18 01:21:48 MS01-11ELKDEV02 logstash[129930]: [2025-09-18T01:21:48,946][INFO ][logstash.outputs.elasticsearch][snowflake] Elasticsearch version determined (8.15.4) {:es_version=>8}
Sep 18 01:21:48 MS01-11ELKDEV02 logstash[129930]: [2025-09-18T01:21:48,948][WARN ][logstash.outputs.elasticsearch][snowflake] Detected a 6.x and above cluster: the `type` event field won't be used to determine the document _type {:es_version=>8}
Sep 18 01:21:49 MS01-11ELKDEV02 logstash[129930]: [2025-09-18T01:21:49,057][INFO ][logstash.javapipeline    ][snowflake] Starting pipeline {:pipeline_id=>"snowflake", "pipeline.workers"=>7, "pipeline.batch.size"=>2500, "pipeline.batch.delay"=>50, "pipeline.max_inflight"=>17500, "pipeline.sources"=>["/etc/logstash/conf.d/snowflake.conf"], :thread=>"#<Thread:0x2e16cf5f run>"}
Sep 18 01:21:49 MS01-11ELKDEV02 logstash[129930]: [2025-09-18T01:21:49,058][WARN ][logstash.javapipeline    ][snowflake] CAUTION: Recommended inflight events max exceeded! Logstash will run with up to 17500 events in memory in your current configuration. If your message sizes are large this may cause instability with the default heap size. Please consider setting a non-standard heap size, changing the batch size (currently 2500), or changing the number of pipeline workers (currently 7) {:pipeline_id=>"snowflake", :thread=>"#<Thread:0x2e16cf5f run>"}
Sep 18 01:21:49 MS01-11ELKDEV02 logstash[129930]: [2025-09-18T01:21:49,788][INFO ][logstash.javapipeline    ][snowflake] Pipeline Java execution initialization time {"seconds"=>0.73}
Sep 18 01:21:49 MS01-11ELKDEV02 logstash[129930]: [2025-09-18T01:21:49,822][INFO ][logstash.inputs.exec     ][snowflake] Registering Exec Input {:type=>nil, :command=>"python3 -W ignore /etc/logstash/scripts/snowflake/snowflake_elastic.py --user 'APP_ELASTIC_SVC_PRD_RSA' --sf_keypair /etc/logstash/keypair/sf_keypair.pem --account 'hedgeservhsc.us-east-1' --warehouse 'DEMO_WH' --sql_query 'sql_warehouse_load_history'", :interval=>1200, :schedule=>nil}
Sep 18 01:21:49 MS01-11ELKDEV02 logstash[129930]: [2025-09-18T01:21:49,850][INFO ][logstash.javapipeline    ][snowflake] Pipeline started {"pipeline.id"=>"snowflake"}
Sep 18 01:21:49 MS01-11ELKDEV02 logstash[129930]: [2025-09-18T01:21:49,926][INFO ][logstash.agent           ] Pipelines running {:count=>1, :running_pipelines=>[:snowflake], :non_running_pipelines=>[]}
Sep 18 01:21:50 MS01-11ELKDEV02 logstash[129930]: [2025-09-18T01:21:50,864][WARN ][logstash.codecs.jsonlines][snowflake][0da34d6ab56b267656de97814aac23781594d84d7dbff875e4d4c414b582e36c] JSON parse error, original data now in message field {:message=>"Unrecognized token 'ERROR': was expecting ('true', 'false' or 'null')\n at [Source: (String)\"ERROR: cannot authenticate to Snowflake\"; line: 1, column: 6]", :exception=>LogStash::Json::ParserError, :data=>"ERROR: cannot authenticate to Snowflake"}
Sep 18 01:21:50 MS01-11ELKDEV02 logstash[129930]: [2025-09-18T01:21:50,890][WARN ][logstash.codecs.jsonlines][snowflake][0da34d6ab56b267656de97814aac23781594d84d7dbff875e4d4c414b582e36c] JSON parse error, original data now in message field {:message=>"Unrecognized token 'ERROR': was expecting ('true', 'false' or 'null')\n at [Source: (String)\"ERROR: Executing snowflake.py script failed\"; line: 1, column: 6]", :exception=>LogStash::Json::ParserError, :data=>"ERROR: Executing snowflake.py script failed"}
